humanRL_gym_ple/modified_dqn_ple.py:116: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(m.weight)
Collecting experience...
humanRL_gym_ple/modified_dqn_ple.py:144: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ../torch/csrc/utils/tensor_new.cpp:201.)
  wrap_tensor = lambda x: torch.tensor([x])
Ep:  0 | Ep_r:  0.0 | Steps:  30 | Total Steps:  31 | Ep_Loss: 0.0000
Ep:  1 | Ep_r:  0.0 | Steps:  113 | Total Steps:  145 | Ep_Loss: 0.0000
Ep:  2 | Ep_r:  0.0 | Steps:  47 | Total Steps:  193 | Ep_Loss: 0.0000
Ep:  3 | Ep_r:  0.0 | Steps:  5 | Total Steps:  199 | Ep_Loss: 0.0000
Ep:  4 | Ep_r:  0.0 | Steps:  329 | Total Steps:  529 | Ep_Loss: 0.0000
Ep:  5 | Ep_r:  0.0 | Steps:  119 | Total Steps:  649 | Ep_Loss: 0.0000
Ep:  6 | Ep_r:  0.0 | Steps:  125 | Total Steps:  775 | Ep_Loss: 0.0000
Ep:  7 | Ep_r:  0.0 | Steps:  71 | Total Steps:  847 | Ep_Loss: 0.0000
Ep:  8 | Ep_r:  0.0 | Steps:  5 | Total Steps:  853 | Ep_Loss: 0.0000
Ep:  9 | Ep_r:  0.0 | Steps:  101 | Total Steps:  955 | Ep_Loss: 0.0000
Ep:  10 | Ep_r:  0.0 | Steps:  5 | Total Steps:  961 | Ep_Loss: 0.0000
Ep:  11 | Ep_r:  0.0 | Steps:  64 | Total Steps:  1026 | Ep_Loss: 0.0000
Ep:  12 | Ep_r:  0.0 | Steps:  43 | Total Steps:  1070 | Ep_Loss: 0.0000
Ep:  13 | Ep_r:  0.0 | Steps:  29 | Total Steps:  1100 | Ep_Loss: 0.0000
Ep:  14 | Ep_r:  0.0 | Steps:  78 | Total Steps:  1179 | Ep_Loss: 0.0000
Ep:  15 | Ep_r:  0.0 | Steps:  27 | Total Steps:  1207 | Ep_Loss: 0.0000
Ep:  16 | Ep_r:  0.0 | Steps:  40 | Total Steps:  1248 | Ep_Loss: 0.0000
max_r_id:  0 0.0
Ep:  17 | Ep_r:  0.0 | Steps:  60 | Total Steps:  1309 | Ep_Loss: 0.0000
Ep:  18 | Ep_r:  0.0 | Steps:  80 | Total Steps:  1390 | Ep_Loss: 0.0000
Ep:  19 | Ep_r:  0.0 | Steps:  23 | Total Steps:  1414 | Ep_Loss: 0.0000
Ep:  20 | Ep_r:  0.0 | Steps:  32 | Total Steps:  1447 | Ep_Loss: 0.0000
Ep:  21 | Ep_r:  0.0 | Steps:  85 | Total Steps:  1533 | Ep_Loss: 0.0000
max_r_id:  0 0.0
Ep:  22 | Ep_r:  0.0 | Steps:  30 | Total Steps:  1564 | Ep_Loss: 0.0000
Ep:  23 | Ep_r:  0.0 | Steps:  5 | Total Steps:  1570 | Ep_Loss: 0.0000
Ep:  24 | Ep_r:  0.0 | Steps:  44 | Total Steps:  1615 | Ep_Loss: 0.0000
Ep:  25 | Ep_r:  0.0 | Steps:  128 | Total Steps:  1744 | Ep_Loss: 0.0000
Ep:  26 | Ep_r:  0.0 | Steps:  26 | Total Steps:  1771 | Ep_Loss: 0.0000
Ep:  27 | Ep_r:  0.0 | Steps:  31 | Total Steps:  1803 | Ep_Loss: 0.0000
Ep:  28 | Ep_r:  0.0 | Steps:  159 | Total Steps:  1963 | Ep_Loss: 0.0000
max_r_id:  0 0.0
Ep:  29 | Ep_r:  0.0 | Steps:  30 | Total Steps:  1994 | Ep_Loss: 0.0000
max_r_id:  0 0.0
Ep:  30 | Ep_r:  0.0 | Steps:  30 | Total Steps:  2025 | Ep_Loss: 5.8639
max_r_id:  0 0.0
Ep:  31 | Ep_r:  0.0 | Steps:  50 | Total Steps:  2076 | Ep_Loss: 12.5101
max_r_id:  0 0.0
Ep:  32 | Ep_r:  0.0 | Steps:  30 | Total Steps:  2107 | Ep_Loss: 6.3495
Ep:  33 | Ep_r:  0.0 | Steps:  5 | Total Steps:  2113 | Ep_Loss: 1.1605
Ep:  34 | Ep_r:  0.0 | Steps:  75 | Total Steps:  2189 | Ep_Loss: 11.7639
Ep:  35 | Ep_r:  0.0 | Steps:  220 | Total Steps:  2410 | Ep_Loss: 21.0294
max_r_id:  0 0.0
Ep:  36 | Ep_r:  0.0 | Steps:  44 | Total Steps:  2455 | Ep_Loss: 3.2341
Ep:  37 | Ep_r:  0.0 | Steps:  138 | Total Steps:  2594 | Ep_Loss: 9.7037
Ep:  38 | Ep_r:  0.0 | Steps:  29 | Total Steps:  2624 | Ep_Loss: 2.0575
Ep:  39 | Ep_r:  0.0 | Steps:  108 | Total Steps:  2733 | Ep_Loss: 7.1169
Ep:  40 | Ep_r:  0.0 | Steps:  41 | Total Steps:  2775 | Ep_Loss: 2.6026
Ep:  41 | Ep_r:  0.0 | Steps:  46 | Total Steps:  2822 | Ep_Loss: 2.8913
max_r_id:  0 0.0
Ep:  42 | Ep_r:  0.0 | Steps:  30 | Total Steps:  2853 | Ep_Loss: 2.0085
Ep:  43 | Ep_r:  0.0 | Steps:  104 | Total Steps:  2958 | Ep_Loss: 6.5717
max_r_id:  0 0.0
Ep:  44 | Ep_r:  0.0 | Steps:  28 | Total Steps:  2987 | Ep_Loss: 1.7651
Ep:  45 | Ep_r:  0.0 | Steps:  5 | Total Steps:  2993 | Ep_Loss: 0.4175
Ep:  46 | Ep_r:  0.0 | Steps:  265 | Total Steps:  3259 | Ep_Loss: 15.1221
Ep:  47 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3265 | Ep_Loss: 0.3474
Ep:  48 | Ep_r:  0.0 | Steps:  32 | Total Steps:  3298 | Ep_Loss: 1.8394
max_r_id:  0 0.0
Ep:  49 | Ep_r:  0.0 | Steps:  30 | Total Steps:  3329 | Ep_Loss: 1.6801
Ep:  50 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3335 | Ep_Loss: 0.2937
max_r_id:  0 0.0
Ep:  51 | Ep_r:  0.0 | Steps:  30 | Total Steps:  3366 | Ep_Loss: 1.5674
max_r_id:  0 0.0
Ep:  52 | Ep_r:  0.0 | Steps:  30 | Total Steps:  3397 | Ep_Loss: 1.5308
Ep:  53 | Ep_r:  0.0 | Steps:  25 | Total Steps:  3423 | Ep_Loss: 1.3759
max_r_id:  0 0.0
Ep:  54 | Ep_r:  0.0 | Steps:  54 | Total Steps:  3478 | Ep_Loss: 3.0226
Ep:  55 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3484 | Ep_Loss: 0.3419
Ep:  56 | Ep_r:  0.0 | Steps:  25 | Total Steps:  3510 | Ep_Loss: 1.3498
max_r_id:  0 0.0
Ep:  57 | Ep_r:  0.0 | Steps:  184 | Total Steps:  3695 | Ep_Loss: 9.8970
max_r_id:  0 0.0
Ep:  58 | Ep_r:  0.0 | Steps:  24 | Total Steps:  3720 | Ep_Loss: 1.2407
max_r_id:  0 0.0
Ep:  59 | Ep_r:  0.0 | Steps:  69 | Total Steps:  3790 | Ep_Loss: 3.8095
Ep:  60 | Ep_r:  0.0 | Steps:  81 | Total Steps:  3872 | Ep_Loss: 4.4162
Ep:  61 | Ep_r:  0.0 | Steps:  52 | Total Steps:  3925 | Ep_Loss: 2.7761
Ep:  62 | Ep_r:  1.0 | Steps:  123 | Total Steps:  4049 | Ep_Loss: 6.9734
Ep:  63 | Ep_r:  0.0 | Steps:  24 | Total Steps:  4074 | Ep_Loss: 1.4700
max_r_id:  62 1.0
Ep:  64 | Ep_r:  0.0 | Steps:  115 | Total Steps:  4190 | Ep_Loss: 7.0016
max_r_id:  62 1.0
Ep:  65 | Ep_r:  0.0 | Steps:  145 | Total Steps:  4336 | Ep_Loss: 7.9725
Ep:  66 | Ep_r:  0.0 | Steps:  192 | Total Steps:  4529 | Ep_Loss: 10.6588
max_r_id:  62 1.0
Ep:  67 | Ep_r:  1.0 | Steps:  123 | Total Steps:  4653 | Ep_Loss: 6.5123
Ep:  68 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4659 | Ep_Loss: 0.2750
Ep:  69 | Ep_r:  1.0 | Steps:  141 | Total Steps:  4801 | Ep_Loss: 7.4838
Ep:  70 | Ep_r:  0.0 | Steps:  30 | Total Steps:  4832 | Ep_Loss: 1.4990
Ep:  71 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4838 | Ep_Loss: 0.2615
Ep:  72 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4844 | Ep_Loss: 0.3222
Ep:  73 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4850 | Ep_Loss: 0.2695
max_r_id:  62 1.0
Ep:  74 | Ep_r:  0.0 | Steps:  115 | Total Steps:  4966 | Ep_Loss: 5.7093
max_r_id:  62 1.0
Ep:  75 | Ep_r:  0.0 | Steps:  115 | Total Steps:  5082 | Ep_Loss: 5.6135
max_r_id:  62 1.0
Ep:  76 | Ep_r:  0.0 | Steps:  64 | Total Steps:  5147 | Ep_Loss: 3.1980
Ep:  77 | Ep_r:  1.0 | Steps:  170 | Total Steps:  5318 | Ep_Loss: 8.6093
max_r_id:  62 1.0
Ep:  78 | Ep_r:  1.0 | Steps:  123 | Total Steps:  5442 | Ep_Loss: 6.1536
Ep:  79 | Ep_r:  0.0 | Steps:  23 | Total Steps:  5466 | Ep_Loss: 1.1208
Ep:  80 | Ep_r:  0.0 | Steps:  5 | Total Steps:  5472 | Ep_Loss: 0.3158
Ep:  81 | Ep_r:  0.0 | Steps:  5 | Total Steps:  5478 | Ep_Loss: 0.2940
max_r_id:  62 1.0
Ep:  82 | Ep_r:  1.0 | Steps:  172 | Total Steps:  5651 | Ep_Loss: 8.0907
Ep:  83 | Ep_r:  0.0 | Steps:  5 | Total Steps:  5657 | Ep_Loss: 0.2334
Ep:  84 | Ep_r:  0.0 | Steps:  39 | Total Steps:  5697 | Ep_Loss: 2.0231
Ep:  85 | Ep_r:  0.0 | Steps:  44 | Total Steps:  5742 | Ep_Loss: 2.1039
Ep:  86 | Ep_r:  0.0 | Steps:  239 | Total Steps:  5982 | Ep_Loss: 10.6788
Ep:  87 | Ep_r:  0.0 | Steps:  251 | Total Steps:  6234 | Ep_Loss: 11.2148
max_r_id:  62 1.0
Ep:  88 | Ep_r:  0.0 | Steps:  90 | Total Steps:  6325 | Ep_Loss: 4.0195
max_r_id:  62 1.0
Ep:  89 | Ep_r:  1.0 | Steps:  95 | Total Steps:  6421 | Ep_Loss: 4.1645
max_r_id:  62 1.0
Ep:  90 | Ep_r:  0.0 | Steps:  47 | Total Steps:  6469 | Ep_Loss: 2.1237
Ep:  91 | Ep_r:  0.0 | Steps:  62 | Total Steps:  6532 | Ep_Loss: 2.8521
max_r_id:  62 1.0
Ep:  92 | Ep_r:  0.0 | Steps:  115 | Total Steps:  6648 | Ep_Loss: 5.1063
Ep:  93 | Ep_r:  0.0 | Steps:  23 | Total Steps:  6672 | Ep_Loss: 1.1434
max_r_id:  62 1.0
Ep:  94 | Ep_r:  0.0 | Steps:  115 | Total Steps:  6788 | Ep_Loss: 4.9370
max_r_id:  62 1.0
Ep:  95 | Ep_r:  0.0 | Steps:  24 | Total Steps:  6813 | Ep_Loss: 1.2164
Ep:  96 | Ep_r:  0.0 | Steps:  63 | Total Steps:  6877 | Ep_Loss: 2.7990
max_r_id:  62 1.0
Ep:  97 | Ep_r:  0.0 | Steps:  115 | Total Steps:  6993 | Ep_Loss: 5.3752
max_r_id:  62 1.0
Ep:  98 | Ep_r:  0.0 | Steps:  90 | Total Steps:  7084 | Ep_Loss: 3.9703
max_r_id:  62 1.0
Ep:  99 | Ep_r:  1.0 | Steps:  110 | Total Steps:  7195 | Ep_Loss: 4.7447
max_r_id:  62 1.0
Ep:  100 | Ep_r:  0.0 | Steps:  90 | Total Steps:  7286 | Ep_Loss: 3.9488
Ep:  101 | Ep_r:  0.0 | Steps:  59 | Total Steps:  7346 | Ep_Loss: 2.7039
max_r_id:  62 1.0
Ep:  102 | Ep_r:  0.0 | Steps:  78 | Total Steps:  7425 | Ep_Loss: 3.2110
max_r_id:  62 1.0
Ep:  103 | Ep_r:  1.0 | Steps:  119 | Total Steps:  7545 | Ep_Loss: 5.3516
Ep:  104 | Ep_r:  0.0 | Steps:  24 | Total Steps:  7570 | Ep_Loss: 0.9551
max_r_id:  3 1.0
Ep:  105 | Ep_r:  0.0 | Steps:  47 | Total Steps:  7618 | Ep_Loss: 2.1630
Ep:  106 | Ep_r:  0.0 | Steps:  5 | Total Steps:  7624 | Ep_Loss: 0.2887
max_r_id:  3 1.0
Ep:  107 | Ep_r:  0.0 | Steps:  24 | Total Steps:  7649 | Ep_Loss: 1.0075
max_r_id:  3 1.0
Ep:  108 | Ep_r:  0.0 | Steps:  47 | Total Steps:  7697 | Ep_Loss: 1.8831
max_r_id:  3 1.0
Ep:  109 | Ep_r:  0.0 | Steps:  191 | Total Steps:  7889 | Ep_Loss: 8.3598
max_r_id:  3 1.0
Ep:  110 | Ep_r:  0.0 | Steps:  90 | Total Steps:  7980 | Ep_Loss: 3.9661
Ep:  111 | Ep_r:  0.0 | Steps:  22 | Total Steps:  8003 | Ep_Loss: 0.8883
max_r_id:  3 1.0
Ep:  112 | Ep_r:  0.0 | Steps:  5 | Total Steps:  8009 | Ep_Loss: 0.2682
max_r_id:  3 1.0
Ep:  113 | Ep_r:  0.0 | Steps:  115 | Total Steps:  8125 | Ep_Loss: 5.0989
Ep:  114 | Ep_r:  0.0 | Steps:  58 | Total Steps:  8184 | Ep_Loss: 2.5320
max_r_id:  3 1.0
Ep:  115 | Ep_r:  0.0 | Steps:  179 | Total Steps:  8364 | Ep_Loss: 7.4000
max_r_id:  3 1.0
Ep:  116 | Ep_r:  0.0 | Steps:  90 | Total Steps:  8455 | Ep_Loss: 4.2128
max_r_id:  3 1.0
Ep:  117 | Ep_r:  1.0 | Steps:  119 | Total Steps:  8575 | Ep_Loss: 5.3457
Ep:  118 | Ep_r:  0.0 | Steps:  32 | Total Steps:  8608 | Ep_Loss: 1.2688
Ep:  119 | Ep_r:  0.0 | Steps:  23 | Total Steps:  8632 | Ep_Loss: 1.0183
max_r_id:  3 1.0
Ep:  120 | Ep_r:  1.0 | Steps:  95 | Total Steps:  8728 | Ep_Loss: 4.3350
Ep:  121 | Ep_r:  0.0 | Steps:  54 | Total Steps:  8783 | Ep_Loss: 2.3683
Ep:  122 | Ep_r:  0.0 | Steps:  90 | Total Steps:  8874 | Ep_Loss: 3.9799
Ep:  123 | Ep_r:  0.0 | Steps:  39 | Total Steps:  8914 | Ep_Loss: 1.7279
Ep:  124 | Ep_r:  0.0 | Steps:  154 | Total Steps:  9069 | Ep_Loss: 6.9051
Ep:  125 | Ep_r:  0.0 | Steps:  27 | Total Steps:  9097 | Ep_Loss: 1.2867
max_r_id:  3 1.0
Ep:  126 | Ep_r:  0.0 | Steps:  24 | Total Steps:  9122 | Ep_Loss: 1.0496
max_r_id:  3 1.0
Ep:  127 | Ep_r:  0.0 | Steps:  151 | Total Steps:  9274 | Ep_Loss: 6.6910
max_r_id:  3 1.0
Ep:  128 | Ep_r:  0.0 | Steps:  115 | Total Steps:  9390 | Ep_Loss: 4.8257
max_r_id:  3 1.0
Ep:  129 | Ep_r:  0.0 | Steps:  115 | Total Steps:  9506 | Ep_Loss: 4.9285
max_r_id:  3 1.0
Ep:  130 | Ep_r:  0.0 | Steps:  115 | Total Steps:  9622 | Ep_Loss: 4.6475
max_r_id:  3 1.0
Ep:  131 | Ep_r:  0.0 | Steps:  86 | Total Steps:  9709 | Ep_Loss: 3.7789
max_r_id:  3 1.0
Ep:  132 | Ep_r:  0.0 | Steps:  24 | Total Steps:  9734 | Ep_Loss: 0.9166
max_r_id:  3 1.0
Ep:  133 | Ep_r:  0.0 | Steps:  115 | Total Steps:  9850 | Ep_Loss: 4.7242
max_r_id:  3 1.0
Ep:  134 | Ep_r:  0.0 | Steps:  26 | Total Steps:  9877 | Ep_Loss: 1.2959
Ep:  135 | Ep_r:  0.0 | Steps:  42 | Total Steps:  9920 | Ep_Loss: 1.6799
Ep:  136 | Ep_r:  0.0 | Steps:  61 | Total Steps:  9982 | Ep_Loss: 2.6689
Ep:  137 | Ep_r:  0.0 | Steps:  26 | Total Steps:  10009 | Ep_Loss: 1.0847
Ep:  138 | Ep_r:  0.0 | Steps:  22 | Total Steps:  10032 | Ep_Loss: 0.9864
max_r_id:  3 1.0
Traceback (most recent call last):
  File "humanRL_gym_ple/modified_dqn_ple.py", line 341, in <module>
    writer.add_scalar(f"charts/eval_epi_r", eval_epi_r, epi)
  File "humanRL_gym_ple/modified_dqn_ple.py", line 300, in rollout
    else:
  File "/home/quantumiracle/research/humanRL_prior_games/humanRL_gym_ple/utils/wrappers.py", line 82, in step
    obs, rews, terminateds, infos = self.env.step(action)
  File "/home/quantumiracle/anaconda3/envs/x/lib/python3.7/site-packages/gym/core.py", line 282, in step
    observation, reward, done, info = self.env.step(action)
  File "/home/quantumiracle/research/humanRL_prior_games/humanRL_gym_ple/ple_env.py", line 64, in step
    state = downsample_image(state, output_size=self.downsample_size)
  File "/home/quantumiracle/research/humanRL_prior_games/humanRL_gym_ple/ple_env.py", line 28, in downsample_image
    output_matrix[i, j, :] = np.mean(block, axis=(0, 1))
  File "<__array_function__ internals>", line 6, in mean
  File "/home/quantumiracle/anaconda3/envs/x/lib/python3.7/site-packages/numpy/core/fromnumeric.py", line 3441, in mean
    out=out, **kwargs)
  File "/home/quantumiracle/anaconda3/envs/x/lib/python3.7/site-packages/numpy/core/_methods.py", line 182, in _mean
    ret, rcount, out=ret, casting='unsafe', subok=False)
KeyboardInterrupt