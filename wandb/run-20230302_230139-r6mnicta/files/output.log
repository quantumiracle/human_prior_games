humanRL_gym_ple/dqn_ple.py:131: UserWarning: nn.init.xavier_uniform is now deprecated in favor of nn.init.xavier_uniform_.
  torch.nn.init.xavier_uniform(m.weight)
Collecting experience...
Ep:  0 | Ep_r:  0.0 | Steps:  27 | Total Steps:  28 | Ep_Loss: 0.0000
humanRL_gym_ple/dqn_ple.py:159: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ../torch/csrc/utils/tensor_new.cpp:201.)
  wrap_tensor = lambda x: torch.tensor([x])
Ep:  1 | Ep_r:  0.0 | Steps:  46 | Total Steps:  75 | Ep_Loss: 0.0000
Ep:  2 | Ep_r:  1.0 | Steps:  118 | Total Steps:  194 | Ep_Loss: 0.0000
Ep:  3 | Ep_r:  0.0 | Steps:  116 | Total Steps:  311 | Ep_Loss: 0.0000
Ep:  4 | Ep_r:  0.0 | Steps:  156 | Total Steps:  468 | Ep_Loss: 0.0000
Ep:  5 | Ep_r:  0.0 | Steps:  22 | Total Steps:  491 | Ep_Loss: 0.0000
Ep:  6 | Ep_r:  0.0 | Steps:  30 | Total Steps:  522 | Ep_Loss: 0.0000
Ep:  7 | Ep_r:  1.0 | Steps:  194 | Total Steps:  717 | Ep_Loss: 0.0000
Ep:  8 | Ep_r:  0.0 | Steps:  160 | Total Steps:  878 | Ep_Loss: 0.0000
Ep:  9 | Ep_r:  1.0 | Steps:  34 | Total Steps:  913 | Ep_Loss: 0.0000
Ep:  10 | Ep_r:  1.0 | Steps:  197 | Total Steps:  1111 | Ep_Loss: 0.0000
Ep:  11 | Ep_r:  0.0 | Steps:  84 | Total Steps:  1196 | Ep_Loss: 0.0000
Ep:  12 | Ep_r:  0.0 | Steps:  82 | Total Steps:  1279 | Ep_Loss: 0.0000
Ep:  13 | Ep_r:  0.0 | Steps:  22 | Total Steps:  1302 | Ep_Loss: 0.0000
Ep:  14 | Ep_r:  0.0 | Steps:  23 | Total Steps:  1326 | Ep_Loss: 0.0000
Ep:  15 | Ep_r:  1.0 | Steps:  89 | Total Steps:  1416 | Ep_Loss: 0.0000
Ep:  16 | Ep_r:  0.0 | Steps:  149 | Total Steps:  1566 | Ep_Loss: 0.0000
Ep:  17 | Ep_r:  0.0 | Steps:  87 | Total Steps:  1654 | Ep_Loss: 0.0000
Ep:  18 | Ep_r:  1.0 | Steps:  55 | Total Steps:  1710 | Ep_Loss: 0.0000
Ep:  19 | Ep_r:  0.0 | Steps:  199 | Total Steps:  1910 | Ep_Loss: 0.0000
Ep:  20 | Ep_r:  1.0 | Steps:  118 | Total Steps:  2029 | Ep_Loss: 9.6812
Ep:  21 | Ep_r:  0.0 | Steps:  126 | Total Steps:  2156 | Ep_Loss: 36.3475
Ep:  22 | Ep_r:  0.0 | Steps:  5 | Total Steps:  2162 | Ep_Loss: 1.5795
Ep:  23 | Ep_r:  0.0 | Steps:  5 | Total Steps:  2168 | Ep_Loss: 1.5008
Ep:  24 | Ep_r:  1.0 | Steps:  25 | Total Steps:  2194 | Ep_Loss: 5.9388
Ep:  25 | Ep_r:  1.0 | Steps:  57 | Total Steps:  2252 | Ep_Loss: 12.2354
Ep:  26 | Ep_r:  1.0 | Steps:  69 | Total Steps:  2322 | Ep_Loss: 12.6607
Ep:  27 | Ep_r:  1.0 | Steps:  29 | Total Steps:  2352 | Ep_Loss: 4.5656
Ep:  28 | Ep_r:  1.0 | Steps:  32 | Total Steps:  2385 | Ep_Loss: 4.0096
Ep:  29 | Ep_r:  1.0 | Steps:  54 | Total Steps:  2440 | Ep_Loss: 5.6109
Ep:  30 | Ep_r:  1.0 | Steps:  193 | Total Steps:  2634 | Ep_Loss: 15.4028
Ep:  31 | Ep_r:  1.0 | Steps:  43 | Total Steps:  2678 | Ep_Loss: 3.1271
Ep:  32 | Ep_r:  0.0 | Steps:  35 | Total Steps:  2714 | Ep_Loss: 2.4083
Ep:  33 | Ep_r:  0.0 | Steps:  5 | Total Steps:  2720 | Ep_Loss: 0.4374
Ep:  34 | Ep_r:  1.0 | Steps:  50 | Total Steps:  2771 | Ep_Loss: 3.6754
Ep:  35 | Ep_r:  0.0 | Steps:  23 | Total Steps:  2795 | Ep_Loss: 1.7650
Ep:  36 | Ep_r:  1.0 | Steps:  57 | Total Steps:  2853 | Ep_Loss: 4.0706
Ep:  37 | Ep_r:  0.0 | Steps:  24 | Total Steps:  2878 | Ep_Loss: 1.7513
Ep:  38 | Ep_r:  0.0 | Steps:  5 | Total Steps:  2884 | Ep_Loss: 0.4306
Ep:  39 | Ep_r:  0.0 | Steps:  17 | Total Steps:  2902 | Ep_Loss: 1.2077
Ep:  40 | Ep_r:  0.0 | Steps:  5 | Total Steps:  2908 | Ep_Loss: 0.4310
Ep:  41 | Ep_r:  0.0 | Steps:  5 | Total Steps:  2914 | Ep_Loss: 0.3913
Ep:  42 | Ep_r:  0.0 | Steps:  17 | Total Steps:  2932 | Ep_Loss: 1.3035
Ep:  43 | Ep_r:  0.0 | Steps:  5 | Total Steps:  2938 | Ep_Loss: 0.4240
Ep:  44 | Ep_r:  0.0 | Steps:  48 | Total Steps:  2987 | Ep_Loss: 3.6736
Ep:  45 | Ep_r:  0.0 | Steps:  27 | Total Steps:  3015 | Ep_Loss: 2.1801
Ep:  46 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3021 | Ep_Loss: 0.4860
Ep:  47 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3027 | Ep_Loss: 0.4185
Ep:  48 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3033 | Ep_Loss: 0.4932
Ep:  49 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3039 | Ep_Loss: 0.4187
Ep:  50 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3045 | Ep_Loss: 0.4950
Ep:  51 | Ep_r:  0.0 | Steps:  32 | Total Steps:  3078 | Ep_Loss: 2.5454
Ep:  52 | Ep_r:  1.0 | Steps:  75 | Total Steps:  3154 | Ep_Loss: 5.6592
Ep:  53 | Ep_r:  0.0 | Steps:  27 | Total Steps:  3182 | Ep_Loss: 2.0031
Ep:  54 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3188 | Ep_Loss: 0.4685
Ep:  55 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3194 | Ep_Loss: 0.3911
Ep:  56 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3200 | Ep_Loss: 0.4367
Ep:  57 | Ep_r:  0.0 | Steps:  27 | Total Steps:  3228 | Ep_Loss: 2.1838
Ep:  58 | Ep_r:  0.0 | Steps:  32 | Total Steps:  3261 | Ep_Loss: 2.3926
Ep:  59 | Ep_r:  0.0 | Steps:  24 | Total Steps:  3286 | Ep_Loss: 1.9060
Ep:  60 | Ep_r:  0.0 | Steps:  25 | Total Steps:  3312 | Ep_Loss: 1.8884
Ep:  61 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3318 | Ep_Loss: 0.3782
Ep:  62 | Ep_r:  0.0 | Steps:  17 | Total Steps:  3336 | Ep_Loss: 1.2925
Ep:  63 | Ep_r:  0.0 | Steps:  23 | Total Steps:  3360 | Ep_Loss: 1.6681
Ep:  64 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3366 | Ep_Loss: 0.4363
Ep:  65 | Ep_r:  0.0 | Steps:  24 | Total Steps:  3391 | Ep_Loss: 1.8473
Ep:  66 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3397 | Ep_Loss: 0.3489
Ep:  67 | Ep_r:  0.0 | Steps:  14 | Total Steps:  3412 | Ep_Loss: 1.1139
Ep:  68 | Ep_r:  0.0 | Steps:  20 | Total Steps:  3433 | Ep_Loss: 1.3873
Ep:  69 | Ep_r:  0.0 | Steps:  36 | Total Steps:  3470 | Ep_Loss: 2.4495
Ep:  70 | Ep_r:  0.0 | Steps:  54 | Total Steps:  3525 | Ep_Loss: 3.9443
Ep:  71 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3531 | Ep_Loss: 0.4155
Ep:  72 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3537 | Ep_Loss: 0.3910
Ep:  73 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3543 | Ep_Loss: 0.4734
Ep:  74 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3549 | Ep_Loss: 0.3902
Ep:  75 | Ep_r:  0.0 | Steps:  18 | Total Steps:  3568 | Ep_Loss: 1.4533
Ep:  76 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3574 | Ep_Loss: 0.4256
Ep:  77 | Ep_r:  0.0 | Steps:  41 | Total Steps:  3616 | Ep_Loss: 2.8432
Ep:  78 | Ep_r:  0.0 | Steps:  49 | Total Steps:  3666 | Ep_Loss: 3.4121
Ep:  79 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3672 | Ep_Loss: 0.4070
Ep:  80 | Ep_r:  0.0 | Steps:  26 | Total Steps:  3699 | Ep_Loss: 1.8078
Ep:  81 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3705 | Ep_Loss: 0.3651
Ep:  82 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3711 | Ep_Loss: 0.3895
Ep:  83 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3717 | Ep_Loss: 0.3561
Ep:  84 | Ep_r:  0.0 | Steps:  42 | Total Steps:  3760 | Ep_Loss: 2.9564
Ep:  85 | Ep_r:  0.0 | Steps:  24 | Total Steps:  3785 | Ep_Loss: 1.6611
Ep:  86 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3791 | Ep_Loss: 0.5059
Ep:  87 | Ep_r:  1.0 | Steps:  47 | Total Steps:  3839 | Ep_Loss: 3.3171
Ep:  88 | Ep_r:  1.0 | Steps:  20 | Total Steps:  3860 | Ep_Loss: 1.4671
Ep:  89 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3866 | Ep_Loss: 0.3615
Ep:  90 | Ep_r:  0.0 | Steps:  22 | Total Steps:  3889 | Ep_Loss: 1.5684
Ep:  91 | Ep_r:  0.0 | Steps:  5 | Total Steps:  3895 | Ep_Loss: 0.4501
Ep:  92 | Ep_r:  0.0 | Steps:  41 | Total Steps:  3937 | Ep_Loss: 2.9701
Ep:  93 | Ep_r:  0.0 | Steps:  45 | Total Steps:  3983 | Ep_Loss: 3.1568
Ep:  94 | Ep_r:  0.0 | Steps:  26 | Total Steps:  4010 | Ep_Loss: 1.7877
Ep:  95 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4016 | Ep_Loss: 0.3144
Ep:  96 | Ep_r:  0.0 | Steps:  26 | Total Steps:  4043 | Ep_Loss: 1.8729
Ep:  97 | Ep_r:  0.0 | Steps:  23 | Total Steps:  4067 | Ep_Loss: 1.5028
Ep:  98 | Ep_r:  0.0 | Steps:  22 | Total Steps:  4090 | Ep_Loss: 1.5221
Ep:  99 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4096 | Ep_Loss: 0.4058
Ep:  100 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4102 | Ep_Loss: 0.3058
Ep:  101 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4108 | Ep_Loss: 0.3585
Ep:  102 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4114 | Ep_Loss: 0.3533
Ep:  103 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4120 | Ep_Loss: 0.3553
Ep:  104 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4126 | Ep_Loss: 0.4042
Ep:  105 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4132 | Ep_Loss: 0.3501
Ep:  106 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4138 | Ep_Loss: 0.3521
Ep:  107 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4144 | Ep_Loss: 0.4118
Ep:  108 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4150 | Ep_Loss: 0.3416
Ep:  109 | Ep_r:  0.0 | Steps:  63 | Total Steps:  4214 | Ep_Loss: 3.8855
Ep:  110 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4220 | Ep_Loss: 0.3642
Ep:  111 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4226 | Ep_Loss: 0.3820
Ep:  112 | Ep_r:  0.0 | Steps:  28 | Total Steps:  4255 | Ep_Loss: 1.9688
Ep:  113 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4261 | Ep_Loss: 0.3790
Ep:  114 | Ep_r:  0.0 | Steps:  40 | Total Steps:  4302 | Ep_Loss: 2.5615
Ep:  115 | Ep_r:  0.0 | Steps:  26 | Total Steps:  4329 | Ep_Loss: 1.6713
Ep:  116 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4335 | Ep_Loss: 0.3042
Ep:  117 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4341 | Ep_Loss: 0.3235
Ep:  118 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4347 | Ep_Loss: 0.3546
Ep:  119 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4353 | Ep_Loss: 0.3276
Ep:  120 | Ep_r:  1.0 | Steps:  36 | Total Steps:  4390 | Ep_Loss: 2.3316
Ep:  121 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4396 | Ep_Loss: 0.3655
Ep:  122 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4402 | Ep_Loss: 0.3884
Ep:  123 | Ep_r:  0.0 | Steps:  26 | Total Steps:  4429 | Ep_Loss: 1.6243
Ep:  124 | Ep_r:  0.0 | Steps:  24 | Total Steps:  4454 | Ep_Loss: 1.5069
Ep:  125 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4460 | Ep_Loss: 0.3386
Ep:  126 | Ep_r:  0.0 | Steps:  22 | Total Steps:  4483 | Ep_Loss: 1.4071
Ep:  127 | Ep_r:  0.0 | Steps:  41 | Total Steps:  4525 | Ep_Loss: 2.3863
Ep:  128 | Ep_r:  1.0 | Steps:  79 | Total Steps:  4605 | Ep_Loss: 4.7690
Ep:  129 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4611 | Ep_Loss: 0.3306
Ep:  130 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4617 | Ep_Loss: 0.3684
Ep:  131 | Ep_r:  1.0 | Steps:  43 | Total Steps:  4661 | Ep_Loss: 2.3648
Ep:  132 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4667 | Ep_Loss: 0.2825
Ep:  133 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4673 | Ep_Loss: 0.4127
Ep:  134 | Ep_r:  0.0 | Steps:  22 | Total Steps:  4696 | Ep_Loss: 1.2061
Ep:  135 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4702 | Ep_Loss: 0.2849
Ep:  136 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4708 | Ep_Loss: 0.3797
Ep:  137 | Ep_r:  0.0 | Steps:  36 | Total Steps:  4745 | Ep_Loss: 1.9053
Ep:  138 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4751 | Ep_Loss: 0.3714
Ep:  139 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4757 | Ep_Loss: 0.2978
Ep:  140 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4763 | Ep_Loss: 0.3638
Ep:  141 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4769 | Ep_Loss: 0.3108
Ep:  142 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4775 | Ep_Loss: 0.3474
Ep:  143 | Ep_r:  1.0 | Steps:  23 | Total Steps:  4799 | Ep_Loss: 1.2486
Ep:  144 | Ep_r:  1.0 | Steps:  46 | Total Steps:  4846 | Ep_Loss: 2.4960
Ep:  145 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4852 | Ep_Loss: 0.3502
Ep:  146 | Ep_r:  1.0 | Steps:  44 | Total Steps:  4897 | Ep_Loss: 2.1860
Ep:  147 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4903 | Ep_Loss: 0.3450
Ep:  148 | Ep_r:  0.0 | Steps:  5 | Total Steps:  4909 | Ep_Loss: 0.3056
Ep:  149 | Ep_r:  1.0 | Steps:  27 | Total Steps:  4937 | Ep_Loss: 1.4671
Ep:  150 | Ep_r:  1.0 | Steps:  25 | Total Steps:  4963 | Ep_Loss: 1.2858
Ep:  151 | Ep_r:  1.0 | Steps:  22 | Total Steps:  4986 | Ep_Loss: 1.1551
Ep:  152 | Ep_r:  1.0 | Steps:  32 | Total Steps:  5019 | Ep_Loss: 1.9239
Ep:  153 | Ep_r:  0.0 | Steps:  5 | Total Steps:  5025 | Ep_Loss: 0.3155
Ep:  154 | Ep_r:  1.0 | Steps:  53 | Total Steps:  5079 | Ep_Loss: 3.0644
Ep:  155 | Ep_r:  1.0 | Steps:  23 | Total Steps:  5103 | Ep_Loss: 1.2611
Ep:  156 | Ep_r:  1.0 | Steps:  44 | Total Steps:  5148 | Ep_Loss: 2.2060
Ep:  157 | Ep_r:  1.0 | Steps:  55 | Total Steps:  5204 | Ep_Loss: 2.8987
Ep:  158 | Ep_r:  1.0 | Steps:  76 | Total Steps:  5281 | Ep_Loss: 4.0441
Ep:  159 | Ep_r:  1.0 | Steps:  132 | Total Steps:  5414 | Ep_Loss: 6.5452
Ep:  160 | Ep_r:  1.0 | Steps:  56 | Total Steps:  5471 | Ep_Loss: 2.8051
Ep:  161 | Ep_r:  0.0 | Steps:  5 | Total Steps:  5477 | Ep_Loss: 0.2739
Ep:  162 | Ep_r:  1.0 | Steps:  30 | Total Steps:  5508 | Ep_Loss: 1.3880
Ep:  163 | Ep_r:  1.0 | Steps:  54 | Total Steps:  5563 | Ep_Loss: 2.8876
Ep:  164 | Ep_r:  1.0 | Steps:  26 | Total Steps:  5590 | Ep_Loss: 1.1990
Ep:  165 | Ep_r:  1.0 | Steps:  32 | Total Steps:  5623 | Ep_Loss: 1.7216
Ep:  166 | Ep_r:  1.0 | Steps:  65 | Total Steps:  5689 | Ep_Loss: 3.4943
Ep:  167 | Ep_r:  1.0 | Steps:  45 | Total Steps:  5735 | Ep_Loss: 2.2539
Ep:  168 | Ep_r:  1.0 | Steps:  31 | Total Steps:  5767 | Ep_Loss: 1.5649
Ep:  169 | Ep_r:  1.0 | Steps:  84 | Total Steps:  5852 | Ep_Loss: 4.0424
Ep:  170 | Ep_r:  1.0 | Steps:  27 | Total Steps:  5880 | Ep_Loss: 1.3014
Ep:  171 | Ep_r:  1.0 | Steps:  11 | Total Steps:  5892 | Ep_Loss: 0.6529
Ep:  172 | Ep_r:  1.0 | Steps:  78 | Total Steps:  5971 | Ep_Loss: 3.6212
Ep:  173 | Ep_r:  1.0 | Steps:  15 | Total Steps:  5987 | Ep_Loss: 0.7790
Ep:  174 | Ep_r:  1.0 | Steps:  52 | Total Steps:  6040 | Ep_Loss: 2.5666
Ep:  175 | Ep_r:  1.0 | Steps:  28 | Total Steps:  6069 | Ep_Loss: 1.3089
Ep:  176 | Ep_r:  1.0 | Steps:  37 | Total Steps:  6107 | Ep_Loss: 1.7452
Ep:  177 | Ep_r:  1.0 | Steps:  23 | Total Steps:  6131 | Ep_Loss: 1.2249
Ep:  178 | Ep_r:  1.0 | Steps:  23 | Total Steps:  6155 | Ep_Loss: 1.0482
Ep:  179 | Ep_r:  1.0 | Steps:  33 | Total Steps:  6189 | Ep_Loss: 1.4442
Traceback (most recent call last):
  File "humanRL_gym_ple/dqn_ple.py", line 393, in <module>
    env.close()
  File "humanRL_gym_ple/dqn_ple.py", line 358, in rollout
    epi_loss += loss
  File "humanRL_gym_ple/dqn_ple.py", line 274, in learn
    none_terminal_next_state_index = torch.tensor([i for i, is_term in enumerate(is_terminal) if is_term == 0], dtype=torch.int64, device=device)
  File "humanRL_gym_ple/dqn_ple.py", line 274, in <listcomp>
    none_terminal_next_state_index = torch.tensor([i for i, is_term in enumerate(is_terminal) if is_term == 0], dtype=torch.int64, device=device)
KeyboardInterrupt